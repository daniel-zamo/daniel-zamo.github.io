---
title: "Estrategia de Backup WSL 2: Grandes Vol√∫menes (>2GB)"
description: "Resoluci√≥n de errores de exportaci√≥n de instancias pesadas y correcci√≥n de sintaxis para 7-Zip en PowerShell."
date: 2026-01-30T10:00:00Z
category: "sop"
systems: ["windows", "linux"]
difficulty: "intermediate"
tags: ["wsl2", "backup", "7zip", "powershell", "troubleshooting"]
author: "Daniel Zamo"
lang: "es"
sidebar:
  label: "WSL 2: Backup >2GB"
  order: 10
  badge:
    text: "SOP"
    variant: caution
---

import { Steps, Aside, LinkCard, CardGrid, Badge } from '@astrojs/starlight/components';

Cuando las distribuciones de WSL exceden los **2GB**, el comando nativo de Windows `Compress-Archive` falla debido a las limitaciones del est√°ndar Zip32. Para entornos de producci√≥n es imperativo utilizar herramientas que soporten **ZIP64** como **7-Zip**.

<Aside type="danger" title="Error Cr√≠tico de E/S">
`System.IO.IOException: Stream was too long.`  
Si encuentras este error en PowerShell, es la confirmaci√≥n de que intentas procesar un volumen que excede la capacidad de las herramientas nativas.
</Aside>

---

## üîÑ Flujo de Empaquetado Robusto

La siguiente l√≥gica de decisi√≥n asegura que el proceso de exportaci√≥n y compresi√≥n mantenga la integridad de los datos seg√∫n el tama√±o del artefacto.

```mermaid
graph TD
    Start([Inicio]) --> SD[wsl --shutdown]
    SD --> Exp[wsl --export]
    Exp --> Size{¬øTama√±o > 2GB?}
    Size -- S√≠ --> Tool[7-Zip / ZIP64]
    Size -- No --> Native[Compress-Archive]
    Tool --> Syntax[Sintaxis: Separaci√≥n por ESPACIOS]
    Syntax --> Final[/"ZIP/ tar.gz generado"/]
    Native --> Final
    
    style Tool fill:#f96,stroke:#333,color:#000
    style Final fill:#2ecc71,stroke:#333,color:#000
```

---

## üõ†Ô∏è Procedimiento de Ejecuci√≥n (PowerShell 7)

Al invocar binarios externos como `7z.exe`, PowerShell maneja los argumentos de forma distinta a los cmdlets. El uso de un **Array Pattern** es la pr√°ctica recomendada para evitar errores de parseo.

<Steps>

1.  **Consistencia de Datos**
    
    Aseguramos que el archivo `.vhdx` no est√© bloqueado.
    ```powershell
    wsl --shutdown
    ```

2.  **Preparaci√≥n del Inventario de Archivos**
    
    Definimos las rutas en un array. PowerShell expandir√° este objeto usando espacios autom√°ticamente al invocar el binario.
    ```powershell
    $dest = "D:\10_Hot-Tier_Caliente\WSL\backups"
    
    $bundleFiles = @(
        "$dest\Ubuntu.tar",
        "$env:APPDATA\alacritty\alacritty.toml",
        "$dest\README_Ubuntu.md"
    )
    ```

3.  **Compresi√≥n con 7-Zip**
    
    Invocaci√≥n directa asegurando que `7z.exe` est√° en el PATH del sistema.
    ```powershell
    7z.exe a -tzip "$dest\WSL_Ubuntu_Migration.zip" $bundleFiles
    ```

</Steps>

---

## ‚ö†Ô∏è Troubleshooting de Sintaxis

| Error Identificado | Causa Ra√≠z | Acci√≥n Correctiva |
| :--- | :--- | :--- |
| `Stream was too long` | L√≠mite Zip32 (2GB). | Migrar a **7-Zip** o **tar.exe**. |
| `Syntax is incorrect` | Uso de comas (`,`) en 7z. | Sustituir comas por **espacios**. |
| `Scan WARNINGS` | Rutas con espacios mal citadas. | Encapsular variables en comillas dobles. |

---

## üîó Referencias Cruzadas

<CardGrid>
  <LinkCard 
    title="SOP: Exportaci√≥n Base" 
    description="Requisitos para generar el archivo .tar inicial." 
    href="/es/tech-notes/howto/wsl-export-guide/" 
  />
</CardGrid>

:::tip[Tip de Verificaci√≥n]
Confirmar siempre el tama√±o del bundle generado:  
`Get-ChildItem "$dest\*.zip" | Select-Object Name, @{N="GB"; E={$_.Length / 1GB}}`
:::

---
**Generado por:** dzamo-sysadmin | **Versi√≥n:** 1.1 | **Fix:** Mermaid Syntax
