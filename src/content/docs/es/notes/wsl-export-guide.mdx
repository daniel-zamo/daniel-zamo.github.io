---
title: "Generaci贸n de Im谩genes Base (Export) en WSL 2"
description: "Gu铆a t茅cnica sobre la captura de im谩genes de sistema de archivos (RootFS) desde instancias activas de WSL 2."
sidebar:
  label: "WSL 2: Export RootFS"
  badge:
    text: "SOP"
    variant: note
---

import { Steps, Aside, Badge } from '@astrojs/starlight/components';

Este procedimiento describe c贸mo extraer el sistema de archivos completo de una distribuci贸n de WSL 2 para convertirlo en un artefacto portable `.tar`. 

<Badge text="Prioridad: Alta" variant="caution" /> <Badge text="Entorno: Windows/WSL2" variant="note" />

---

##  Flujo de Generaci贸n

A diferencia de un snapshot de VM tradicional, WSL requiere un volcado del sistema de archivos (*RootFS*). El flujo garantiza la consistencia de los punteros de archivos.

```mermaid
graph LR
    Running[Distro en Ejecuci贸n] --> Stop[wsl --shutdown]
    Stop --> Verify[Validar Estado: Stopped]
    Verify --> Command[wsl --export]
    Command --> Artifact[Archivo .tar]
```

---

##  Ejecuci贸n del Procedimiento

Para evitar archivos bloqueados por el kernel de Linux y garantizar la integridad del sistema de archivos, siga estos pasos desde **PowerShell 7** con privilegios de usuario est谩ndar.

<Steps>

1.  **Preparaci贸n del Entorno**
    
    Detenemos el motor de WSL por completo. Esto cerrar谩 todas las distros activas.
    ```powershell
    wsl --shutdown
    ```

2.  **Validaci贸n de Estado**
    
    Aseg煤rese de que la distribuci贸n objetivo aparece como `Stopped`.
    ```powershell
    wsl --list --verbose
    ```

3.  **Comandos de Exportaci贸n**
    
    El comando captura el estado exacto de la instancia, incluyendo paquetes en `/usr`, configuraciones en `/etc` y datos en `/home`.

    ```powershell
    # Definir ruta de salida (Tier Caliente de Almacenamiento)
    $storage = "D:\10_Hot-Tier_Caliente\WSL\backups"

    # Exportar instancia de Ubuntu
    wsl --export Ubuntu "$storage\Ubuntu-$(get-date -f yyyyMMdd).tar"

    # Exportar instancia de Rocky Linux 9
    wsl --export RockyLinux9 "$storage\RockyLinux9-$(get-date -f yyyyMMdd).tar"
    ```

</Steps>

---

##  Diagn贸stico y Puntos Cr铆ticos

<Aside type="danger" title="Riesgo de Corrupci贸n">
**Nunca** ejecute un export sin haber realizado un `--shutdown` previo. Aunque WSL permite el comando, los archivos abiertos (especialmente bases de datos o sockets) pueden quedar en un estado inconsistente dentro del `.tar`.
</Aside>

<Aside type="tip" title="Gesti贸n de Espacio">
El proceso de exportaci贸n no aplica compresi贸n por defecto. Aseg煤rese de que el disco de destino tiene un espacio libre al menos **1.2x** superior al tama帽o del archivo `ext4.vhdx` original.
</Aside>

### Notas de Implementaci贸n
- **Permisos:** El comando captura los atributos de Linux (UID/GID) correctamente, independientemente del usuario que ejecute PowerShell.
- **Portabilidad:** El archivo resultante puede ser importado en cualquier m谩quina Windows mediante `wsl --import`.

---
**Documentaci贸n de Referencia:** [Microsoft Docs - WSL Management](https://learn.microsoft.com/en-us/windows/wsl/basic-commands)
**Autor:** `dzamo-sysadmin` | **Versi贸n:** 1.0
