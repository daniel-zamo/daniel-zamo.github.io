---
/* src/components/LabEnvironment.astro */
import { Image } from "astro:assets";
// Aseg√∫rate de que tu imagen est√© en src/assets/images/
import topologyImg from "../assets/images/lab-01-topology.png"; 
---

<div class="lab-card">
  <!-- Cabecera -->
  <div class="card-header">
    <span class="icon">üñß</span>
    <strong>Infrastructure Context</strong>
  </div>

  <!-- Imagen del Diagrama -->
  <div class="img-wrapper">
    <Image
      src={topologyImg}
      alt="Network Topology Diagram"
      width={800}
      class="topology-img"
    />
  </div>

  <!-- Contenido -->
  <div class="info-content">
    <p class="intro-text">
      Access via SSH from the <strong>default terminal</strong>. The cluster
      topology is defined below:
    </p>
    
    <!-- Simulaci√≥n de archivo /etc/hosts -->
    <div class="terminal-window">
      <div class="terminal-bar">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot green"></span>
        <span class="terminal-title">üìÑ /etc/hosts (Cluster Inventory)</span>
      </div>
      <div class="terminal-body">
        <pre><code>
<span class="comment"># Management & Controller</span>
10.0.0.15   terminal       <span class="comment"># Main Entry Point</span>

<span class="comment"># Web & Application Tier</span>
10.0.0.60   web-srv1   <span class="comment"># Nginx / Apache</span>
10.0.0.70   app-srv1    <span class="comment"># Backend App</span>

<span class="comment"># Data Persistence Tier</span>
10.0.0.80   data-001    <span class="comment"># Primary DB</span>
10.0.0.90   data-002    <span class="comment"># Replica / Backup</span>

<span class="comment"># Virtualization & Containers</span>
10.0.0.100  kvm-001        <span class="comment"># Libvirt Hypervisor</span>
10.0.0.110  docker-001     <span class="comment"># Container Runtime</span>
</code></pre>
      </div>
    </div>

    <!-- Alerta de Seguridad -->
    <div class="security-alert">
      <div class="alert-icon">‚ö†Ô∏è</div>
      <div class="alert-text">
        <strong>Constraint:</strong> Nested SSH is forbidden. Connect directly from
        <code>terminal</code> to target IPs.
      </div>
    </div>
  </div>
</div>

<style>
  /* 1. Contenedor Principal */
  .lab-card {
    border: 1px solid var(--sl-color-gray-5);
    background-color: var(--sl-color-gray-6);
    border-radius: 0.5rem;
    overflow: hidden;
    margin-bottom: 2rem;
    box-shadow: var(--sl-shadow-sm);
  }

  /* 2. Cabecera */
  .card-header {
    background-color: var(--sl-color-gray-5);
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
    border-bottom: 1px solid var(--sl-color-gray-4);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: var(--sl-color-white);
  }

  /* 3. Imagen */
  .img-wrapper {
    /* Usamos variable de fondo para adaptarse si alg√∫n d√≠a pones modo claro */
    background-color: var(--sl-color-black); 
    padding: 1rem;
    display: flex;
    justify-content: center;
    border-bottom: 1px solid var(--sl-color-gray-5);
  }

  .topology-img {
    height: auto;
    max-width: 100%;
    object-fit: contain;
    border-radius: 4px;
  }

  /* 4. Contenido */
  .info-content {
    padding: 1.2rem;
  }

  .intro-text {
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: var(--sl-color-gray-2);
  }

  /* 5. Terminal Window */
  .terminal-window {
    background-color: #1e1e1e; /* Mantenemos oscuro duro para look terminal */
    border-radius: 6px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    margin-bottom: 1.5rem;
    border: 1px solid #333;
    overflow: hidden;
  }

  .terminal-bar {
    background-color: #2d2d2d;
    padding: 6px 10px;
    display: flex;
    align-items: center;
    border-bottom: 1px solid #333;
  }

  .dot {
    height: 10px;
    width: 10px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 6px;
  }
  .dot.red { background-color: #ff5f56; }
  .dot.yellow { background-color: #ffbd2e; }
  .dot.green { background-color: #27c93f; }

  .terminal-title {
    margin-left: 10px;
    color: #999;
    font-family: monospace;
    font-size: 0.8rem;
  }

  .terminal-body {
    padding: 1rem;
    overflow-x: auto;
  }

  pre {
    margin: 0;
    font-family: var(--sl-font-mono); /* Usar fuente mono del tema */
    font-size: 0.85rem;
    line-height: 1.5;
    color: #e0e0e0;
    background: transparent !important;
    border: none !important;
  }

  .comment {
    color: #6a9955;
    font-style: italic;
  }

  /* 6. Alerta - Usando colores sem√°nticos de Starlight */
  .security-alert {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    /* Usamos variables de advertencia de Starlight */
    background-color: var(--sl-color-orange-low); 
    border: 1px solid var(--sl-color-orange-high);
    padding: 0.75rem;
    border-radius: 6px;
    color: var(--sl-color-orange-high);
    font-size: 0.85rem;
  }

  .alert-icon {
    font-size: 1.2rem;
  }
</style>

